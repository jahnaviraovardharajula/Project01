<!DOCTYPE html><html><body style="font-family:sans-serif;padding:10px;"><label>Card<input id="card"></label><label>Expiry<input id="exp"></label><label>CVV<input id="cvv"></label><label>ZIP<input id="zip"></label><script>function luhn(n){let s=0,a=!1;for(let e=n.length-1;e>=0;e--){let t=parseInt(n[e]);a&&(t*=2,t>9&&(t-=9)),s+=t,a=!a}return s%10==0}window.addEventListener("message",(n=>{if(n.origin!==window.location.origin)return;if("requestSubmit"===n.data.type){const e=card.value.replace(/\D/g,""),t=exp.value,o=cvv.value,r=zip.value;if(!/^\d{13,19}$/.test(e)||!luhn(e))return parent.postMessage({type:"validationError",message:"Invalid card"},n.origin);if(!/^\d{2}\/\d{2}$/.test(t))return parent.postMessage({type:"validationError",message:"Invalid expiry"},n.origin);if(!/^\d{3,4}$/.test(o))return parent.postMessage({type:"validationError",message:"Invalid CVV"},n.origin);if(!/^\d{5}$/.test(r))return parent.postMessage({type:"validationError",message:"Invalid ZIP"},n.origin);parent.postMessage({type:"validData",payload:{cardNumber:e,expiryDate:t,cvv:o,zip:r}},n.origin)}}));</script></body></html>